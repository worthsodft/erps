"use strict";const e=require("../../common/vendor.js");if(!Array){(e.resolveComponent("uni-easyinput")+e.resolveComponent("v-button-w80"))()}Math||((()=>"../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../components/v-button-w80/v-button-w80.js"))();const a={__name:"form",setup(a){const n=e.ref(e.index.$json.defaultAvatar),t=e.ref({avatar:"",nickname:"",realname:"",phone:""});function o({detail:a}){a.code&&e.index.$http.post("v1/getPhoneNumberByCode",{code:a.code}).then((e=>{t.value.phone=e.data.phone}))}function l({detail:e}){let a=e.avatarUrl;t.value.avatar=a}function i({detail:e}){e.value&&(t.value.nickname=e.value)}function u(){(t.value.avatar?t.value.nickname?t.value.phone||e.index.$tool.tip("请选择电话号码"):e.index.$tool.tip("请输入昵称"):e.index.$tool.tip("请选择头像"))&&(e.index.$tool.isRemoteUrl(t.value.avatar)?v():async function(a){let n={filePath:t.value.avatar,name:"file"};const o=await e.index.$http.upload("v1/upload",n);t.value.avatar=o.data.url,a&&a()}((()=>{v()})))}e.index.$api.getUserInfo((e=>{t.value=e.data.userInfo}));const v=e.index.$tool.throttle((()=>{let a={avatar:t.value.avatar,nickname:t.value.nickname,realname:t.value.realname,phone:t.value.phone};e.index.$http.post("v1/updateUserInfo",a).then((a=>{1==a.code?(e.index.$login.updateTokenCache(a.data),e.index.$tool.tip(a.info||"操作成功",!0,(()=>{e.index.$tool.back()}))):e.index.$tool.tip(a.info||"操作失败")}))}));return(a,v)=>e.e({a:t.value.avatar||n.value,b:!t.value.avatar},(t.value.avatar,{}),{c:e.o(l),d:e.o(i),e:e.o((e=>t.value.nickname=e)),f:e.p({type:"nickname",placeholder:"请输入昵称",modelValue:t.value.nickname}),g:e.o((e=>t.value.realname=e)),h:e.p({placeholder:"请输入真实姓名",modelValue:t.value.realname}),i:e.p({disabled:!0,value:t.value.phone,placeholder:"点击获取电话号码"}),j:e.o(o),k:e.o(u),l:e.p({title:"保存提交"})})}},n=e._export_sfc(a,[["__scopeId","data-v-66462efc"]]);wx.createPage(n);
