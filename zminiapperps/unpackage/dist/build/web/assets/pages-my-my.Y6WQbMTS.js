import{j as e,y as t,e as a,o as n,c as s,w as o,b as i,f as l,t as u,l as r,i as c,g as d,a as f,F as v,r as p,z as _,h as m,q as g,s as h}from"./index-CL6v0dEt.js";import{_ as y}from"./uni-icons.BqWKhNLa.js";import{o as $,r as b,b as k}from"./uni-app.es.BP3-VgdY.js";import{_ as x}from"./_plugin-vue_export-helper.BCo6x5W8.js";const j=x({__name:"v-user-banner",setup(f,{expose:v}){const p=e(t.defaultAvatar),_=e({}),m=e();function g(){uni.$api.getUserInfo((e=>{_.value=e.data.userInfo}))}function h(){uni.$tool.navto("/pages/my/form")}function k(){uni.$tool.tip("H5不支持跳转设置")}return m.value=-1==t.domain.indexOf("erp."),$((()=>{g()})),v({reload:function(){g()}}),(e,t)=>{const f=c,v=d,g=b(a("uni-icons"),y);return n(),s(v,{class:"container-v main"},{default:o((()=>[i(v,{class:"user-info",onClick:h},{default:o((()=>[i(f,{class:"avatar",src:_.value.avatar||p.value,mode:"aspectFill"},null,8,["src"]),i(v,{class:"v-ml-20"},{default:o((()=>[i(v,{class:"uni-h6 v-font-s30 v-ellip",style:{width:"400rpx","line-height":"40rpx"}},{default:o((()=>[l(u(_.value.nickname||"点击登录"),1)])),_:1}),_.value.realname?(n(),s(v,{key:0,class:"uni-h6 v-font-s20"},{default:o((()=>[l("姓名："+u(_.value.realname),1)])),_:1})):r("",!0),m.value?(n(),s(v,{key:1,class:"v-font-s20"},{default:o((()=>[l("测试版")])),_:1})):r("",!0)])),_:1})])),_:1}),i(v,{class:"set"},{default:o((()=>[i(v,{onClick:k},{default:o((()=>[i(g,{type:"gear",size:"30",color:"#fff"})])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-96f292c3"]]),C=x({__name:"v-user-bar",setup(t,{expose:a}){const r=e(0),c=e(0),f=e();async function v(){const e=await uni.$http.get("v1/getUserBarData");if(1!=e.code)return uni.$tool.tip(e.info||"系统错误");r.value=e.data.couponCount,c.value=e.data.balance,f.value=e.data.expire_at}function p(){uni.$tool.navto("/pages/my/coupon")}function _(){uni.$tool.navto("/pages/pay/money-log")}return $((()=>{uni.$login.judgeLogin().then((()=>{v()}))})),a({reload:function(){v()}}),(e,t)=>{const a=d;return n(),s(a,{class:"container-h bar"},{default:o((()=>[i(a,{class:"item",onClick:p},{default:o((()=>[i(a,{class:"number"},{default:o((()=>[l(u(r.value),1)])),_:1}),i(a,{class:"title"},{default:o((()=>[l("优惠券")])),_:1})])),_:1}),i(a,{class:"item",onClick:_},{default:o((()=>[i(a,{class:"number"},{default:o((()=>[l(u(c.value),1)])),_:1}),i(a,{class:"title"},{default:o((()=>[l("余 额")])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-1a727b5a"]]),I=x({__name:"v-user-order-tabs",setup(t){const c=e();return $((()=>{uni.$login.judgeLogin().then((()=>{uni.$http.get("v1/getUserOrderTabsData").then((e=>{c.value=e.data.tabsData}))}))})),(e,t)=>{const _=b(a("uni-icons"),y),m=d;return n(),s(m,{class:"container-h main"},{default:o((()=>[(n(!0),f(v,null,p(c.value,((e,t)=>(n(),s(m,{class:"item",key:t,onClick:t=>{return a=e.status,void uni.$tool.navto("/pages/order/list?status="+a);var a}},{default:o((()=>[i(_,{type:e.icon,size:"30",color:"#6abfff"},null,8,["type"]),i(m,{class:"title"},{default:o((()=>[l(u(e.title),1)])),_:2},1024),e.count>0?(n(),s(m,{key:0,class:"count"},{default:o((()=>[l(u(e.count),1)])),_:2},1024)):r("",!0)])),_:2},1032,["onClick"])))),128))])),_:1})}}},[["__scopeId","data-v-f410ef3f"]]),w=x({__name:"v-user-service-item",props:{item:Object,index:[String,Number]},emits:["doService"],setup(e,{emit:t}){const c=e,f=t;function v(){f("doService",c.item)}return(t,c)=>{const f=b(a("uni-icons"),y),p=d,g=_,h=m;return n(),s(p,{class:"container-h service-item"},{default:o((()=>["set"==e.item.type?(n(),s(g,{key:0,class:"v-reset-button open-button","open-type":"openSetting"},{default:o((()=>[i(p,{class:"left"},{default:o((()=>[i(f,{type:e.item.icon,color:"#6a6a6a",size:"20"},null,8,["type"]),l(" "+u(e.item.title||""),1)])),_:1}),i(p,{class:"right"},{default:o((()=>[i(f,{type:"right",color:"#6a6a6a",size:"20"})])),_:1})])),_:1})):(n(),s(p,{key:1,class:"menu-item",onClick:v},{default:o((()=>[i(p,{class:"left"},{default:o((()=>[i(f,{type:e.item.icon,color:"#6a6a6a",size:"20"},null,8,["type"]),i(p,{class:"title"},{default:o((()=>[l(u(e.item.title||""),1)])),_:1}),e.item.desc?(n(),s(h,{key:0,class:"desc"},{default:o((()=>[l(u(e.item.desc),1)])),_:1})):r("",!0)])),_:1}),i(p,{class:"right"},{default:o((()=>[i(f,{type:"right",color:"#6a6a6a",size:"20"})])),_:1})])),_:1}))])),_:1})}}},[["__scopeId","data-v-a6d54139"]]),z=x({__name:"v-user-service",setup(t){e(g().globalData.servicePhone);const i=e([]);let l=null;function u(e){l=e;let t=l.type;"path"==t?r():"phonecall"==t?uni.$tool.tip("系统拨号"):"set"==t?uni.$tool.tip("H5不支持跳转设置"):"logout"==t?uni.$tool.confirm("确定要清除用户缓存吗？",(()=>{uni.$login.logout(),uni.$tool.tip("已清除用户缓存",!0,(()=>{uni.$tool.index()}))})):"order_finish"==t?uni.$login.judgePhone((async()=>{const e=await uni.$http.post("v1/isAuthFinishOrder");if(1!=e.code)return uni.$tool.tip(e.info||"系统错误");let t="/page_subs/manager/order_finish/order_finish_welcome";uni.$tool.navto(t)})):"order_deliver"==t?async function(){uni.$login.judgePhone((async()=>{const e=await uni.$http.post("v1/isAuthDeliverOrder");if(1!=e.code)return uni.$tool.tip(e.info||"系统错误");let t="/page_subs/manager/order_deliver/order_deliver_list";uni.$tool.navto(t)}))}():"update"==t?uni.$tool.checkUpdateApp(!1):r()}function r(){if(!l.url)return uni.$tool.tip("暂无跳转链接");uni.$tool.navto(l.url,(e=>{uni.$tool.tip("暂缓开放")}))}return uni.$http.get("v1/getServiceMenu").then((e=>{i.value=e.data.list})),(e,t)=>{const l=b(a("v-user-service-item"),w),r=d;return n(),s(r,{class:"container-v main"},{default:o((()=>[(n(!0),f(v,null,p(i.value,((e,t)=>(n(),s(l,{class:"v-w100",key:e.id,index:t,item:e,onDoService:u},null,8,["index","item"])))),128))])),_:1})}}},[["__scopeId","data-v-76f5b345"]]),D=x({__name:"v-version",setup(a){const i=e(t.version);return(e,t)=>{const a=d;return n(),s(a,{class:"container-h main"},{default:o((()=>[l(" v"+u(i.value),1)])),_:1})}}},[["__scopeId","data-v-01efcccc"]]),S=x({__name:"my",setup(t){const l=e(),u=e();return $((()=>{uni.$api.getCartTotal()})),k((()=>{l.value.reload(),u.value.reload(),setTimeout((()=>{h()}),200)})),(e,t)=>{const r=b(a("v-user-banner"),j),c=b(a("v-user-bar"),C),f=b(a("v-user-order-tabs"),I),v=b(a("v-user-service"),z),p=b(a("v-version"),D),_=d;return n(),s(_,{class:"container-v my"},{default:o((()=>[i(r,{ref_key:"userBannerRef",ref:l},null,512),i(c,{ref_key:"userBarRef",ref:u},null,512),i(f),i(v),i(p)])),_:1})}}},[["__scopeId","data-v-f52467b4"]]);export{S as default};
