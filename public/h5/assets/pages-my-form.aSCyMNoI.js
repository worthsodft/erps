import{j as a,e,c as l,w as t,g as o,o as n,b as u,f as s,l as i,y as r,R as m,i as p,h as v,z as c,Q as d}from"./index-C0uxPSrd.js";import{_ as f}from"./uni-easyinput.BcFWWB_E.js";import{r as h}from"./uni-app.es.riDY3n56.js";import{_}from"./v-button-w80.CkkdNAZw.js";import{_ as $}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.D4sVfuiR.js";const k=$({__name:"form",setup($){const k=a(r.defaultAvatar),V=a({avatar:"",nickname:"",realname:"",phone:""});function b({detail:a}){m({success(a){V.value.avatar=a.tempFilePaths[0]}})}function j(){(V.value.avatar?V.value.nickname?V.value.phone||uni.$tool.tip("请选择电话号码"):uni.$tool.tip("请输入昵称"):uni.$tool.tip("请选择头像"))&&(uni.$tool.isRemoteUrl(V.value.avatar)?y():async function(a){let e={filePath:V.value.avatar,name:"file"};const l=await uni.$http.upload("v1/upload",e);V.value.avatar=l.data.url,a&&a()}((()=>{y()})))}uni.$api.getUserInfo((a=>{V.value=a.data.userInfo}));const y=uni.$tool.throttle((()=>{let a={avatar:V.value.avatar,nickname:V.value.nickname,realname:V.value.realname,phone:V.value.phone};uni.$http.post("v1/updateUserInfo",a).then((a=>{1==a.code?(uni.$login.updateTokenCache(a.data),uni.$tool.tip(a.info||"操作成功",!0,(()=>{uni.$tool.back()}))):uni.$tool.tip(a.info||"操作失败")}))}));return(a,r)=>{const m=p,$=v,y=o,U=c,g=h(e("uni-easyinput"),f),w=d,x=h(e("v-button-w80"),_);return n(),l(y,{class:"container-v main"},{default:t((()=>[u(w,{class:"container-v form"},{default:t((()=>[u(U,{class:"v-reset-button choose",onClick:b},{default:t((()=>[u(m,{class:"avatar",src:V.value.avatar||k.value,mode:"aspectFill"},null,8,["src"]),V.value.avatar?i("",!0):(n(),l(y,{key:0,class:"avatar-tip"},{default:t((()=>[u($,null,{default:t((()=>[s("点击获取")])),_:1})])),_:1}))])),_:1}),u(y,{class:"form-item"},{default:t((()=>[u(g,{modelValue:V.value.nickname,"onUpdate:modelValue":r[0]||(r[0]=a=>V.value.nickname=a),placeholder:"请输入昵称"},null,8,["modelValue"])])),_:1}),u(y,{class:"form-item"},{default:t((()=>[u(g,{modelValue:V.value.realname,"onUpdate:modelValue":r[1]||(r[1]=a=>V.value.realname=a),placeholder:"请输入真实姓名"},null,8,["modelValue"])])),_:1}),u(y,{class:"form-item"},{default:t((()=>[u(g,{modelValue:V.value.phone,"onUpdate:modelValue":r[2]||(r[2]=a=>V.value.phone=a),placeholder:"请输入电话号码"},null,8,["modelValue"])])),_:1})])),_:1}),u(x,{style:{marginTop:"80rpx"},onAction:j,title:"保存提交"})])),_:1})}}},[["__scopeId","data-v-b3ae80bb"]]);export{k as default};
