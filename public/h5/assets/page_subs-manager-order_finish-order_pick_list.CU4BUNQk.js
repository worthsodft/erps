import{_ as e}from"./uni-section.DZlENV4I.js";import{j as t,o as a,c as l,w as s,b as o,f as u,t as i,a as d,F as r,r as n,l as c,n as m,h as _,g as f,e as v,O as p}from"./index-Bk6Bf557.js";import{a as b,r as g}from"./uni-app.es.VV1Xt59_.js";import{_ as k}from"./uni-datetime-picker.CP3cSpXz.js";import{_ as y}from"./uni-load-more.ZwF_zjD4.js";import{_ as h}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.JjreYIGb.js";const P=h({__name:"v-order-pick-item",props:{item:Object,index:Number},emits:["pick"],setup(e,{emit:v}){const p=t(uni.$enum),b=v,g=e;function k(){b("pick",g.item)}return(t,v)=>{const b=_,g=f;return a(),l(g,{class:"order-item"},{default:s((()=>[o(g,{class:"info"},{default:s((()=>[o(g,{class:"title v-mb-10"},{default:s((()=>[o(b,{class:"v-bold"},{default:s((()=>[u("配送水站：")])),_:1}),o(b,{class:"color-desc"},{default:s((()=>[u(i(e.item.station_title),1)])),_:1})])),_:1}),o(g,{class:"title v-mb-10"},{default:s((()=>[o(b,{class:"v-bold"},{default:s((()=>[u("配送单号：")])),_:1}),o(b,{class:"color-desc"},{default:s((()=>[u(i(e.item.gid_),1)])),_:1})])),_:1}),o(g,{class:"v-mb-10"},{default:s((()=>[o(b,{class:"v-bold"},{default:s((()=>[u("发起人：")])),_:1}),o(g,{class:"v-inline color-desc"},{default:s((()=>[u(i(e.item.username),1)])),_:1})])),_:1}),o(g,{class:"v-mb-10"},{default:s((()=>[o(b,{class:"v-bold"},{default:s((()=>[u("发起时间：")])),_:1}),o(g,{class:"v-inline color-desc"},{default:s((()=>[u(i(e.item.create_at),1)])),_:1})])),_:1}),o(g,{class:"v-mb-10"},{default:s((()=>[o(b,{class:"v-bold"},{default:s((()=>[u("商品总件数：")])),_:1}),o(g,{class:"v-inline color-desc v-bold"},{default:s((()=>[u(i(e.item.goods_total||"")+" 件",1)])),_:1})])),_:1}),o(g,{class:"order-subs v-w100 v-mb-10"},{default:s((()=>[o(g,{class:"v-bold"},{default:s((()=>[u("商品列表：")])),_:1}),(a(!0),d(r,null,n(e.item.goods_list,((e,t)=>(a(),l(g,{class:"order-sub",key:e.id},{default:s((()=>[o(g,{class:"order-sub-item"},{default:s((()=>[o(b,null,{default:s((()=>[u(i(e.goods_name),1)])),_:2},1024),o(g,null,{default:s((()=>[o(b,{class:"v-bold v-mr-10"},{default:s((()=>[u(i(e.goods_total),1)])),_:2},1024),o(b,null,{default:s((()=>[u(i(e.goods_unit),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),e.item.remark?(a(),l(g,{key:0,class:"order-subs v-w100 v-mb-10"},{default:s((()=>[o(b,{class:"v-bold"},{default:s((()=>[u("备注：")])),_:1}),o(g,{class:"v-inline color-desc"},{default:s((()=>[u(i(e.item.remark),1)])),_:1})])),_:1})):c("",!0),e.item.confirm_by?(a(),l(g,{key:1,class:"v-mb-10"},{default:s((()=>[o(b,{class:"v-bold"},{default:s((()=>[u("确认人：")])),_:1}),o(g,{class:"v-inline color-desc"},{default:s((()=>[u(i(e.item.confirm_by_username),1)])),_:1})])),_:1})):c("",!0),e.item.confirm_at?(a(),l(g,{key:2,class:"v-mb-10"},{default:s((()=>[o(b,{class:"v-bold"},{default:s((()=>[u("确认时间：")])),_:1}),o(g,{class:"v-inline color-desc"},{default:s((()=>[u(i(e.item.confirm_at),1)])),_:1})])),_:1})):c("",!0)])),_:1}),o(g,{class:"operate"},{default:s((()=>[o(g,{class:"order-status"},{default:s((()=>[e.item.status==p.value.orderPick.STATUS_PICK_NOT?(a(),l(b,{key:0,class:"color-red"},{default:s((()=>[u("未配货")])),_:1})):e.item.status==p.value.orderPick.STATUS_PICK_YES?(a(),l(b,{key:1,class:"color-green"},{default:s((()=>[u("已配货")])),_:1})):c("",!0)])),_:1}),o(g,{class:"order-btns"},{default:s((()=>[e.item.status==p.value.orderPick.STATUS_PICK_NOT?(a(),l(g,{key:0,class:"btn-sm btn-green",onClick:m(k,["stop"])},{default:s((()=>[u("确认配货")])),_:1})):c("",!0)])),_:1})])),_:1})])),_:1})}}},[["__scopeId","data-v-497b78c6"]]),j=h({__name:"order_pick_list",setup(u){let i=uni.$tool.today();const c=t([i,i]),m=t("more"),_=t([]);let h=t(0),j=1;function S(e){uni.$tool.confirm("确认要配货吗？",(()=>{uni.$http.post("v1/orderPickConfirm/"+e.gid).then((e=>{uni.$tool.tip("配货成功"),C(),$("reset")}))}))}function T(e){0==e.length?c.value=[i,i]:c.value=e,C(),$("reset")}function C(){m.value="more",j=1,h.value=0}function $(e){"more"==m.value&&(m.value="loading",uni.$http.post("v1/getMyStationOrderPickPageData",{page:j,createAtRange:c.value}).then((t=>{if(1!=t.code)return uni.$tool.tip(t.info||"系统错误");let a=t.data.pageData;if(h.value=a.total,0==a.total)return m.value="nomore",void(_.value=[]);0!=a.data.length?(_.value="reset"==e?[...a.data]:[..._.value,...a.data],h.value=a.total,_.value.length>=h.value?m.value="nomore":(m.value="more",j++)):m.value="nomore"})))}return $(),b((()=>{$()})),(t,u)=>{const i=g(v("uni-section"),e),b=g(v("uni-datetime-picker"),k),j=f,C=g(v("uni-load-more"),y);return a(),l(j,{class:"container-v order-finish-list"},{default:s((()=>[o(j,{class:"v-w100 v-mb-10"},{default:s((()=>[o(i,{title:"发起时间：",type:"line"}),o(j,{style:{width:"90%","margin-left":"5%"}},{default:s((()=>[o(b,{modelValue:c.value,"onUpdate:modelValue":u[0]||(u[0]=e=>c.value=e),type:"daterange",onChange:T,rangeSeparator:"至"},null,8,["modelValue"])])),_:1}),o(i,{title:"配货单数："+p(h),type:"line"},null,8,["title"])])),_:1}),o(j,{class:"order-finish-item"},{default:s((()=>[(a(!0),d(r,null,n(_.value,((e,t)=>(a(),l(j,{key:e.id},{default:s((()=>[o(P,{item:e,onPick:S},null,8,["item"])])),_:2},1024)))),128)),o(C,{status:m.value,onClick:$},null,8,["status"])])),_:1})])),_:1})}}},[["__scopeId","data-v-d95a8652"]]);export{j as default};
